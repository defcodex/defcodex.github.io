---
---
<!doctype html>
<html lang="{{ site.lang | default: 'en' }}">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% if page.title %}{{ page.title }} | {% endif %}{{ site.title }}</title>
    {%- seo -%}
    <meta name="google-site-verification" content="BnYi8QG6r4gw74jhzry-W7LS5h4nfYFpJWD9aCh8i00">
    <link rel="stylesheet" href="{{ '/assets/css/style.css?v=' | append: site.github.build_revision | relative_url }}">
    <link rel="stylesheet" href="{{ '/assets/css/main.css' | relative_url }}">
    <link rel="alternate" type="application/atom+xml" href="{{ '/feed.xml' | relative_url }}">

    <!-- Modern counter badge styles -->
    <style>
      .counter-wrap { display:flex; gap:.5rem; align-items:center; margin-top:1rem; }
      .counter-pill {
        display:inline-flex; align-items:center; gap:.4rem;
        padding:.25rem .6rem; border:1px solid var(--border-color, #e5e7eb);
        border-radius:999px; background:var(--pill-bg, rgba(0,0,0,.04));
        font-size:.875rem; line-height:1.25rem;
      }
      .counter-pill svg { width:1rem; height:1rem; opacity:.75; flex:0 0 auto; }
      @media (prefers-color-scheme: dark) {
        .counter-pill { border-color: rgba(255,255,255,.18); background: rgba(255,255,255,.06); }
      }
    </style>

    <!-- hits.sh-only counter helper (increments via SVG beacon, then reads JSON) -->
    <script>
      window.fetchCounter = async function ({ namespace, key }) {
        const fmt = (n) => new Intl.NumberFormat().format(n);

        // Normalize key: trim leading/trailing slashes; root -> 'home'
        const normKey = (key || 'home').replace(/^\/+|\/+$/g, '') || 'home';

        // Build hits.sh path safely: encode each segment, keep slashes between
        const segments = normKey.split('/').filter(Boolean);
        const path = [namespace, ...segments].map(encodeURIComponent).join('/');

        // 1) increment via invisible SVG beacon
        try {
          const img = new Image();
          img.referrerPolicy = 'no-referrer';
          img.decoding = 'async';
          img.src = `https://hits.sh/${path}.svg?style=flat&label=hits&_=${Date.now()}`;
        } catch (_) {}

        // 2) read value via JSON
        try {
          const r = await fetch(`https://hits.sh/${path}.json?secure=1&_=${Date.now()}`, { cache: 'no-store' });
          if (r.ok) {
            const d = await r.json();
            if (typeof d?.hits === 'number') return fmt(d.hits);
          }
        } catch (_) {}

        return '—';
      };
    </script>
  </head>

  <body>
    <section class="page-header">
      <h1 class="project-name">
        <a href="{{ '/' | relative_url }}" class="no-underline">{{ site.title }}</a>
      </h1>
      {%- if site.description -%}
      <h2 class="project-tagline">{{ site.description }}</h2>
      {%- endif -%}
      <nav class="header-nav" aria-label="Primary">
        <a class="btn" href="{{ '/' | relative_url }}">Home</a>
        <a class="btn" href="{{ '/blog/' | relative_url }}">Blog</a>
        <a class="btn" href="{{ '/tools/' | relative_url }}">Tools</a>
        <a class="btn" href="{{ '/about/' | relative_url }}">About</a>
        <a class="btn" href="{{ '/contact/' | relative_url }}">Contact</a>
      </nav>
    </section>

    <section class="main-content container">
      {{ content }}

      <footer class="site-footer">
        <p>© {{ site.time | date: '%Y' }} {{ site.title }} ·
          <a href="{{ '/rss/' | relative_url }}">RSS</a>
        </p>
      </footer>

      <!-- site-wide total view counter -->
      <div class="site-stats counter-wrap" aria-live="polite">
        <span class="counter-pill" title="Total site views">
          <!-- eye icon -->
          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M1.5 12s3.5-7.5 10.5-7.5S22.5 12 22.5 12s-3.5 7.5-10.5 7.5S1.5 12 1.5 12Z" stroke="currentColor"/>
            <circle cx="12" cy="12" r="3.5" stroke="currentColor" />
          </svg>
          <strong id="site-views">—</strong>
        </span>
      </div>
    </section>

    <!-- Site-wide total counter init (hits.sh only) -->
    <script>
      (function () {
        const ns  = '{{ site.counter.namespace | default: "defcodex.github.io" }}';
        const key = '{{ site.counter.site_total_key | default: "site-total" }}';

        window.fetchCounter({ namespace: ns, key })
          .then(val => { const el = document.getElementById('site-views'); if (el) el.textContent = val; });
      })();
    </script>
  </body>
</html>
